WORKFLOW REPAIR SUMMARY
=======================

Run ID: 18356088414
Workflow: Crypto Prices
Status: NEEDS MANUAL FIX

WHAT WAS BROKEN
---------------
The crypto-prices.yml workflow failed with a git push rejection error:
  ! [rejected]        main -> main (fetch first)
  error: failed to push some refs

This is a classic race condition that occurs when:
1. Workflow checks out main at commit X
2. Another workflow/commit pushes to main (now at commit Y)
3. This workflow tries to push, but main has moved forward
4. Git rejects the push to prevent data loss

ROOT CAUSE
----------
- The workflow runs every 30 minutes (cron: '*/30 * * * *')
- Multiple workflows in this repo commit directly to main
- No synchronization mechanism between concurrent runs
- Standard git push fails when remote has diverged

THE FIX
-------
Add `git pull --rebase origin main || true` before `git push` in the commit step.

This will:
- Pull any new changes from remote
- Rebase the local commit on top of them
- Allow the push to succeed
- The `|| true` prevents failure if there's nothing to rebase

IMPLEMENTATION STATUS
--------------------
❌ Cannot be auto-fixed - GitHub App lacks 'workflows' permission to modify workflow files
✅ GitHub Issue created: https://github.com/jamiew/clactions/issues/9

MANUAL ACTION REQUIRED
---------------------
Edit .github/workflows/crypto-prices.yml lines 44-56:

  - name: Commit crypto data
    run: |
      git config user.name "github-actions[bot]"
      git config user.email "github-actions[bot]@users.noreply.github.com"
      git add data/crypto-prices.json
      if git diff --staged --quiet; then
        echo "No changes to commit"
      else
        git commit -m "Update crypto prices - $(date -u +"%B %d, %Y")"
        # Pull and rebase to handle concurrent workflow runs
        git pull --rebase origin main || true
        git push
      fi

RECOMMENDED
-----------
Apply the same pattern to other frequently-running workflows:
- nytimes-headlines.yml
- weather-data.yml
- glif-top-content.yml
- Any other workflow that commits directly to main

This will prevent similar race conditions across the entire system.
